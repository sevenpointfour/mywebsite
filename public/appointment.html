 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Add TinyMCE script from CDN (replace API key if needed) -->
    <script src="https://cdn.tiny.cloud/1/s7g5cgt18q6g9dw7ud0p9tksgllbcoyz3bb071o39s55c7ac/tinymce/7/tinymce.min.js" referrerpolicy="origin"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book an Appointment - Your Health Hub</title>
    <link rel="stylesheet" href="main_style.css">
</head>
<body>
    <div id="navbar-placeholder"></div>

    <main>
        <section class="page-title-section">
            <h1>Schedule Your Appointment</h1>
        </section>

        <!-- Make the main content editable via TinyMCE -->
        <textarea id="editor" style="min-height: 500px;">
            <section class="content-section">
                <p>We're excited to help you on your journey to better health. Please find the options below to schedule your appointment with us. If you have any questions before booking, feel free to <a href="contact.html">contact us</a>.</p>

                <div class="appointment-options" style="margin-top: 30px;">
                    
                    <div class="about-card-item card-green" style="margin-bottom: 20px; padding: 20px;">
                        <h3>Personalized Health Consultation</h3>
                        <p>Ready for a one-on-one session? Our personalized health consultations are designed to understand your unique needs and create a tailored wellness plan.</p>
                        <p><strong>To book:</strong> Please call us at <a href="tel:+910000000000">+91 00000 00000</a> or email us at <a href="mailto:info@yourbrand.com">info@yourbrand.com</a> with your preferred dates and times.</p>
                        <a href="consultation-info.html" class="cta-button" style="margin-top: 15px;">Learn More About Consultations</a>
                    </div>

                    <div class="about-card-item card-blue" style="margin-bottom: 20px; padding: 20px;">
                        <h3>Other Services & Programs</h3>
                        <p>Interested in our specialized programs, courses, or introduction talks? Please specify the service you're interested in when contacting us.</p>
                        <p><strong>Contact us:</strong> Reach out via phone at <a href="tel:+910000000000">+91 00000 00000</a> or email <a href="mailto:info@yourbrand.com">info@yourbrand.com</a>.</p>
                        <a href="services.html" class="cta-button" style="margin-top: 15px;">Explore All Services</a>
                    </div>

                    <!-- Placeholder for a future online booking form/system -->
                    <!-- 
                    <div class="about-card-item card-yellow" style="margin-bottom: 20px; padding: 20px;">
                        <h3>Online Booking (Coming Soon)</h3>
                        <p>We are working on an online booking system for your convenience. In the meantime, please use the contact methods above.</p>
                    </div>
                    -->
                </div>

                <div style="margin-top: 30px;">
                    <h2>What to Expect</h2>
                    <p>Once you request an appointment, our team will get in touch with you to confirm the details, discuss any preliminary information required, and answer any questions you might have. We look forward to connecting with you!</p>
                </div>
            </section>
        </textarea>
        <button id="saveButton" class="cta-button" style="margin-top: 20px; margin-left: 20px;">Save Content</button>
        <div id="status" style="margin-top: 1rem; font-style: italic; color: #555;"></div>
    </main>

    <footer>
        <p>&copy; 2024 Your Name/Brand. All rights reserved.</p>
    </footer>

    <script src="load-navbar.js"></script>
    <!-- TinyMCE initialization and admin logic -->
    <script>
        // Derive pageNameForContent from the HTML filename
        let pageNameForContent = window.location.pathname.split("/").pop() || "index.html";
        if (pageNameForContent.endsWith('.html')) {
            pageNameForContent = pageNameForContent.slice(0, -5);
        }
        if (pageNameForContent === "" || pageNameForContent === "index.html") {
            pageNameForContent = "index";
        }

        const adminToken = localStorage.getItem('adminWebsiteToken');
        const saveButton = document.getElementById('saveButton');
        const statusDiv = document.getElementById('status');
        const isReadOnly = !adminToken;

        if (isReadOnly) {
            saveButton.style.display = 'none';
        } else {
            saveButton.style.display = 'block';
        }

        tinymce.init({
            selector: 'textarea#editor',
            readonly: isReadOnly,
            plugins: 'code table lists image link media wordcount help',
            toolbar: isReadOnly ? false : 'undo redo | blocks | bold italic | alignleft aligncenter alignright | indent outdent | bullist numlist | code | table | image link media | help',
            menubar: !isReadOnly,
            height: 500,
            setup: function(editor) {
                editor.on('init', function() {
                    loadContent();
                });
            }
        });

        async function loadContent() {
            statusDiv.textContent = `Loading content for '${pageNameForContent}'...`;
            try {
                const response = await fetch(`/api/page-content/${pageNameForContent}`);
                if (!response.ok) throw new Error(`Failed to load content. Status: ${response.status}`);
                const data = await response.json();
                if (data && data.content) {
                    tinymce.get('editor').setContent(data.content);
                }
                statusDiv.textContent = `Content for '${pageNameForContent}' loaded.`;
            } catch (error) {
                console.error('Error loading content:', error);
                statusDiv.textContent = `Error: ${error.message}`;
            }
        }

        if (!isReadOnly) {
            saveButton.addEventListener('click', async () => {
                const content = tinymce.get('editor').getContent();
                const token = localStorage.getItem('adminWebsiteToken');
                if (!token) {
                    alert('You must be logged in to save content.');
                    statusDiv.textContent = 'Error: Not logged in.';
                    return;
                }
                statusDiv.textContent = `Saving content for '${pageNameForContent}'...`;
                try {
                    const response = await fetch(`/api/page-content/${pageNameForContent}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify({ content: content })
                    });
                    const result = await response.json();
                    if (response.ok) {
                        statusDiv.textContent = result.message || 'Content saved successfully!';
                        alert('Content saved successfully!');
                    } else {
                        throw new Error(result.error || 'An unknown error occurred.');
                    }
                } catch (error) {
                    console.error('Error saving content:', error);
                    statusDiv.textContent = `Error saving content: ${error.message}`;
                    alert(`Error saving content: ${error.message}`);
                }
            });
        }
    </script>
</body>